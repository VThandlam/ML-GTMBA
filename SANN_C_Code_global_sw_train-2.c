//Analysis Type - Regression 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double global_sw_train_2_MLP_10_39_1_input_hidden_weights[39][10]=
{
 {-2.35694158189188e-001, 4.64885120388708e-001, 2.51877014118168e+000, 6.27013647905251e-001, 5.33706753363704e-001, 9.19688889899539e-001, -4.59900917744370e+000, -7.87388657923945e-001, -1.05763776159842e+000, -5.02608269043932e+000 },
 {4.20913301493908e-001, -2.80912452067761e-001, -9.07983846308074e+000, -1.40982866509875e+000, -3.83294053425305e+000, -4.70188631600338e+000, 2.36660799433590e+000, 1.74042852752794e+000, -1.05576186667653e+000, -7.92145923504468e-001 },
 {8.66736216762690e-001, -6.61052195019273e-003, -8.81182417966788e+000, -8.44147040131551e+000, 2.48454291795268e+000, -1.21844952638816e-002, -2.60180123818886e+000, -1.75700690630868e+000, 3.37780271940926e-001, -4.88868567030267e-001 },
 {-3.46986853088898e+000, -6.73278808254604e-001, -1.44832203773664e+001, -2.63779152669813e+000, -3.68067293605966e+000, 8.47087503974944e+000, -7.09436739096197e+000, -3.56980180970300e+000, 4.41377637128939e-001, 2.60420385588165e+000 },
 {9.77227819563922e-001, -3.28159370809235e-001, 1.16335830152949e+001, 1.03643568339706e+001, -3.24999398925082e+001, -2.39922923685464e+001, 6.38659130849898e+000, 2.00472149422978e+001, -6.59861177093053e-001, 1.00241979748654e+001 },
 {7.28248465197082e+000, 2.67493395680559e-001, 4.87204730429410e+000, -8.23396749094395e-001, -3.10746379677205e+000, 5.96498457870282e-001, -2.65832836585531e+000, -2.51072184601330e+000, 5.63821914063062e-001, 6.57848143923889e+000 },
 {-4.96210003924196e+000, 1.58592987426763e-001, -3.64635519483242e+000, 6.32377327694860e+000, -3.20357137974565e-001, -4.37323960611250e+000, -4.73846013430703e-001, 2.16909292050199e+000, 4.32547165316758e-001, 2.42661681137094e+000 },
 {4.12247180018507e-001, -4.22496817073734e-002, 7.30294072842352e-001, -1.99104652556105e+000, 3.11476292716252e+000, -8.12899767716614e-001, 2.13070222616567e+000, 2.28652661802169e+000, -8.72707194560176e-001, -3.44541840652744e+000 },
 {-5.80561022700083e+000, -3.00524515905982e-002, 9.21641113801322e-001, -9.57154240008698e-001, -2.39091292796902e+000, 1.40789811045700e+000, 3.35165923877167e+000, 2.60794474057640e+000, -6.49334753421940e-001, 2.75222198482777e-001 },
 {-5.80614652553504e-001, -9.23268103394719e-002, 6.40019939551565e-001, 6.53254981915402e-001, 2.95068717185236e+000, 1.24278952233130e+000, 6.95304645015079e-001, 1.23287463077785e+000, -1.14551352306802e+000, -8.61803098218899e+000 },
 {1.57121404540193e+001, -7.81592368968649e-001, 3.90761461788654e+000, -5.76894255216468e+000, -1.55382079136804e+001, -7.30398113738183e+000, 1.06402612673225e+001, 2.48533954852967e+001, -1.26715584119946e+000, -8.67387300856872e+000 },
 {-9.75453485434145e-002, 1.09219333346191e-001, 4.23304447726919e-002, 2.61377974052742e-001, 2.19201434304804e+000, 6.69687469935128e-001, -5.25120497010548e-001, -2.77480623412279e-001, 4.72466006690355e-001, -7.65155195139844e+000 },
 {-4.84651069840011e+000, -9.49313246261618e-001, 9.06685064803749e+000, -6.96008172737280e-002, -2.86609768831464e+000, -3.52606602105079e-001, -5.44747494820885e+000, -4.57218629240113e+000, -8.04532322661949e-001, 5.40822281683872e+000 },
 {1.89664284411840e-002, 1.08892404457593e-001, 4.53888334601266e-002, 9.13523409498549e-002, 3.36773954322502e+000, 1.13783308003797e+000, -4.73533722035624e-001, -1.34016157267218e-001, 1.57854453870823e+000, -8.21507715734180e+000 },
 {-2.93190354296577e+000, 1.33056227360326e-001, 9.74650686554179e+000, 3.54975269164933e+001, -3.97323817696054e+000, 3.43219724486270e-001, -7.02004487957220e-001, 1.78207549520034e+000, -6.61240879402149e-001, -2.69468858200599e+000 },
 {-2.68767589680575e-001, -1.15979185354283e-001, -8.90023774943865e+000, -6.75125927963999e+000, 1.29502870887627e+000, -8.71977924268716e-001, -2.04519624685370e+000, -1.30402945802002e+000, 1.61259659634932e-001, 5.43434702413786e-001 },
 {-3.24351588520247e+000, 1.18095550742463e-001, 4.24392083285360e+000, 2.07866443197221e+000, -1.14906756816397e+000, 2.88633808076301e-001, -1.33641222845572e+000, -1.15469196706334e+000, -7.52215724257019e-002, 1.57016984485954e+000 },
 {-2.65306470950594e+001, -4.70783680297917e-001, 1.16296874737772e+001, -1.86796210714891e+000, -1.14065739665017e+000, 4.61722990363205e+000, -7.45948704854792e-001, 6.31787086757175e-002, 2.16915368461744e-001, -7.56200698743665e-001 },
 {-6.66695603544424e-001, 3.18182453459267e-001, 7.82440875853284e+000, 4.59435881223348e+000, 4.73014222592070e+000, 6.27824780612075e+000, 4.85963392921905e+000, 1.80632466140621e+000, 9.86031724474224e-001, -6.34618699902155e+000 },
 {1.33148037267073e+000, -2.94012035674566e-001, -3.17674917477351e+000, -1.48592603188229e+000, 8.71817871866844e+000, 1.97120244568670e-001, -1.46571043445078e+001, 1.99358631716629e+000, -5.27836099635570e-001, 5.14817814270740e-001 },
 {-6.45304159916825e+000, -2.62616810876406e-001, 7.35088184137527e+000, 5.11475725302291e-001, -1.68517522369124e+000, 1.81054658119536e+000, 2.65102289160630e+000, -5.68857949475529e-001, -1.30570189742753e-001, -1.37430345965405e+000 },
 {-4.43465853646031e+000, 1.23862671233625e-001, -2.70770750294505e+000, 5.92835214029698e+000, -3.45138841241088e-001, -3.44656745575345e+000, -3.57720578701207e-001, 1.77639294548687e+000, 3.27117570138649e-001, 1.79667145263479e+000 },
 {-5.74795227293210e+000, -7.65057120063015e-001, 2.65917858086635e+001, -8.94890408129376e+000, 1.92782158355868e+000, 1.20507006373859e+001, 1.25084360938199e+001, 9.77465869799778e+000, -1.42649286345740e+000, -4.65904640352578e+000 },
 {-4.99680442432855e+000, -1.27812868348789e-003, 5.69455220466422e+000, 9.26566114131158e-002, -2.50903469175739e+000, 8.64071273371877e-001, 1.16296113618227e+000, -9.82849097381593e-001, -7.65482979567734e-002, 5.24961224732006e-002 },
 {-7.00563963151929e+000, 9.08690614808347e-001, 3.45586533321809e-001, 1.35177873376679e+001, -2.29988788384932e+000, -7.32481694870414e+000, -4.03048143386964e+000, 7.37396667999227e+000, 1.19984327687480e+000, 8.03158265131671e+000 },
 {-8.81216230006267e-001, 4.57376067193941e-002, -5.50604993734696e+000, 1.59830179919058e+001, -5.63671524686048e+000, 1.92659990607294e+000, -1.01978759110151e+001, -1.00443237636092e+001, 1.56230705245551e+000, 8.26164181497696e+000 },
 {-1.96503585244652e+000, 1.09008817401912e-002, 5.88182109569042e+000, 3.24746136126804e-002, -6.72341811761898e-001, 2.78996729414474e-001, 1.50025400620749e+000, 1.58817336640566e+000, -2.01748015209854e-001, -1.11624221862247e+000 },
 {-6.28942454349669e-001, 1.98013166211378e-002, 1.96078713780729e-001, 8.14005076797944e-001, 4.52974432353346e-001, 3.73287607419381e-001, 8.09833697342686e-001, 7.18574663012015e-001, 2.06789509236156e-001, -5.79519510200700e+000 },
 {1.04274165276686e-001, 1.52938833669740e-002, -1.27732346207875e+000, -2.03909571968820e+000, -1.61513730617102e+000, 8.10807418919580e-001, -8.01604910681365e-001, -2.62011183605830e-001, -1.63656572461329e-001, -1.85310538452430e+000 },
 {-7.46906159625178e-001, -3.93231529054125e-002, 7.45517222366932e-001, -5.46799992714440e+000, 2.88907738498168e+000, 7.28658443008865e-001, -3.16186860535715e-001, 7.25959732236760e-002, 3.42490364492811e-002, -1.04227455078876e+000 },
 {-7.07107718776942e-001, 1.99363678527050e-002, 1.65040330629577e+000, -2.43922599025690e+000, -1.15996966350240e+000, 2.68894263568672e+000, -7.70667333476784e-001, 8.32112868213683e-001, -9.62084659394200e-002, 5.11574965515960e-001 },
 {1.88077096836624e+000, -6.95825420384024e-002, -2.65820904405640e+000, 1.37583062857639e+000, -1.06278293973755e+000, -5.05107971201536e+000, 7.38561033361011e-001, 4.70431158028551e-002, -8.14635126864290e-001, -2.11362574510232e+000 },
 {5.43542561317408e-001, -1.93503284414435e-002, 1.91525041863799e+000, -4.95944361684782e+000, 3.69904185047950e+000, 7.68963146579272e-003, 1.32088224873431e+000, 1.66929873321448e+000, -9.74061087648900e-001, -2.68209857929356e+000 },
 {-2.02280694285233e+000, -6.12839165080017e-002, 4.23356943984100e+000, -9.78113517352893e+000, 4.95024177702521e+000, 2.52015619034749e+000, -1.06408052453262e-001, 6.11064237719464e-001, 2.00399085330682e-001, -2.11807675007785e+000 },
 {9.30894031384182e-001, 1.85162926938140e-001, -6.23813500467009e+000, 9.61245188310419e+000, -2.88750918401272e+000, -8.82307892149636e+000, 1.07406040059502e+000, 4.97234131327883e-001, -8.34735918524223e-001, 1.35624067158871e+000 },
 {-5.75237221273994e+000, -7.34160037490501e-001, 2.74403600666821e+001, -8.75870495391630e+000, 1.44917279281785e+000, 1.17733740490154e+001, 1.33739786007130e+001, 1.04650748722175e+001, -1.50620623635407e+000, -4.68434282835382e+000 },
 {-2.37293271154022e+000, -1.05568648783125e-001, 9.96996545376496e+000, -1.83754499058924e+001, 4.41696579473918e+000, 1.52845833322204e+000, 4.94719379848661e-003, 3.50366539809040e-001, -1.99641419789757e-003, -1.17035194769789e+000 },
 {-8.68913139199352e+000, -1.56767168606492e+000, -1.40202652808398e+001, -9.16085411505865e+000, 2.73989874094681e+000, 5.85283529302665e-001, 7.53335168317043e+000, 3.85827233171294e+000, 1.35206880846444e+000, 6.07195477809411e+000 },
 {-9.56642650502942e-001, -1.85542392910189e-001, -8.53581869212987e+000, -6.13575320808918e+000, 1.27318458619877e+000, -1.32976684325990e+000, -1.53218811680350e+000, -9.08425996379782e-001, 1.14516422521965e-001, 9.77319108313320e-001 } 
};

double global_sw_train_2_MLP_10_39_1_hidden_bias[39]={ -2.63283344569231e+000, 5.20434489516356e+000, 3.53386576151115e+000, 1.44812997408714e+001, -5.30169073384992e+000, -7.79216120691597e+000, -3.96807223695090e+000, -1.76874352642639e+000, -1.52369630593333e+000, -4.79870126290338e-001, -9.25769060752227e+000, -1.68333899623081e+000, -2.19436501472686e+000, -3.40537548441548e+000, -3.80351658811908e+001, 4.00700366382986e+000, -3.45235993469021e+000, 1.77004219921903e+000, -1.13178067668100e+001, 2.75005349297341e+000, -3.77322264282120e+000, -3.79527895539663e+000, -2.76576116075270e+001, -1.75642354435427e+000, -1.76413960892207e+001, -1.26332765648095e+000, -9.00812161331122e+000, 1.66966648708475e+000, 1.91727422587752e+000, -2.18035689088777e+000, -1.32611527753126e+000, 2.54815926867049e+000, -1.91133916206985e+000, -3.29879522468478e+000, 4.53893386082647e-001, -2.86677107851007e+001, -1.10386490638026e+001, -7.84202319416278e+000, 3.63990350117667e+000 };

double global_sw_train_2_MLP_10_39_1_hidden_output_wts[1][39]=
{
 {5.37145275092268e+000, 1.23666137070090e-001, -2.12594766978559e+000, 4.58939621906945e-002, -2.69857611489547e-002, 8.84943549467612e-002, -1.31638155878436e+000, 9.79774930195522e-001, -2.12286185851526e-001, -9.24429171518082e-001, -1.98238250083731e-002, -8.42942201975144e+000, 6.93334993677966e-002, 5.15873956196929e+000, -3.97883964032112e-001, 6.33621898491128e+000, -9.52085763114290e-001, 6.43427599834822e-002, -7.17110178357150e-002, -3.77011809874037e-002, -5.31930260729878e-001, 1.64492962921082e+000, 6.44329749451446e-001, 9.64597201117464e-001, 7.04999892247675e-002, 9.36937091912375e-002, 7.37437085933202e+000, -6.50264226712031e-001, -1.53710265255568e+000, 3.24112349380060e+000, 4.53836720415477e-001, -3.32951373471888e-001, -8.60780588321156e-001, -7.20314949152330e-001, 9.13318545031978e-002, -6.07989705511497e-001, -9.74649149057933e+000, 1.43864329206752e-001, -4.49220153831098e+000 }
};

double global_sw_train_2_MLP_10_39_1_output_bias[1]={ -2.19238210240716e-001 };

double global_sw_train_2_MLP_10_39_1_max_input[10]={ 1.20000000000000e+001, 3.10000000000000e+001, 2.10000000000000e+001, 3.57000000000000e+002, 9.56300000000000e+001, 3.16100000000000e+002, 9.95600000000000e+001, 3.34200000000000e+002, 1.00000000000000e+002, 3.54900000000000e+002 };

double global_sw_train_2_MLP_10_39_1_min_input[10]={ 1.00000000000000e+000, 1.00000000000000e+000, -2.00000000000000e+001, 0.00000000000000e+000, 1.77200000000000e+001, 1.66400000000000e+002, 6.55800000000000e+000, 1.46300000000000e+002, 0.00000000000000e+000, 1.80000000000000e+001 };

double global_sw_train_2_MLP_10_39_1_max_target[1]={ 3.69900000000000e+002 };

double global_sw_train_2_MLP_10_39_1_min_target[1]={ 1.00000000000000e-001 };

double global_sw_train_2_MLP_10_39_1_input[10];
double global_sw_train_2_MLP_10_39_1_hidden[39];
double global_sw_train_2_MLP_10_39_1_output[1];

double global_sw_train_2_MLP_10_39_1_MeanInputs[10]={ 6.53760733488484e+000, 1.57207537517053e+001, 7.30975644009309e-001, 2.00200535671294e+002, 7.00499845016495e+001, 2.36381029812970e+002, 7.00068703956378e+001, 2.36252807760188e+002, 6.27374523513394e+001, 2.33353885121578e+002 };

void global_sw_train_2_MLP_10_39_1_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(global_sw_train_2_MLP_10_39_1_max_input[i]-global_sw_train_2_MLP_10_39_1_min_input[i]);
	input[i] = minimum - delta*global_sw_train_2_MLP_10_39_1_min_input[i]+ delta*input[i];
 }
}

void global_sw_train_2_MLP_10_39_1_UnscaleTargets(double* output, double minimum, double maximum, int size)
{
  double delta;
  long i;
  for(i=0; i<size; i++)
  {
    delta = (maximum-minimum)/(global_sw_train_2_MLP_10_39_1_max_target[i]-global_sw_train_2_MLP_10_39_1_min_target[i]);
    output[i] = (output[i] - minimum + delta*global_sw_train_2_MLP_10_39_1_min_target[i])/delta;
   }
}

double global_sw_train_2_MLP_10_39_1_logistic(double x)
{
  if(x > 100.0) x = 1.0;
  else if (x < -100.0) x = 0.0;
  else x = 1.0/(1.0+exp(-x));
  return x;
}

void global_sw_train_2_MLP_10_39_1_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = global_sw_train_2_MLP_10_39_1_logistic(V_OUT[row]);
      if(layer==1) V_OUT[row] = exp(V_OUT[row]);
   }
}

void global_sw_train_2_MLP_10_39_1_RunNeuralNet_Regression () 
{
  global_sw_train_2_MLP_10_39_1_ComputeFeedForwardSignals((double*)global_sw_train_2_MLP_10_39_1_input_hidden_weights,global_sw_train_2_MLP_10_39_1_input,global_sw_train_2_MLP_10_39_1_hidden,global_sw_train_2_MLP_10_39_1_hidden_bias,10, 39,0);
  global_sw_train_2_MLP_10_39_1_ComputeFeedForwardSignals((double*)global_sw_train_2_MLP_10_39_1_hidden_output_wts,global_sw_train_2_MLP_10_39_1_hidden,global_sw_train_2_MLP_10_39_1_output,global_sw_train_2_MLP_10_39_1_output_bias,39, 1,1);
}

int main()
{
  int cont_inps;
  int i=0;
  int keyin=1;
  while(1)
  {
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(MON): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[0]);
	printf("%s","Cont. Input-1(DAY): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[1]);
	printf("%s","Cont. Input-2(LAT): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[2]);
	printf("%s","Cont. Input-3(LON): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[3]);
	printf("%s","Cont. Input-4(CAFC): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[4]);
	printf("%s","Cont. Input-5(SWC): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[5]);
	printf("%s","Cont. Input-6(CAFM): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[6]);
	printf("%s","Cont. Input-7(SWM): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[7]);
	printf("%s","Cont. Input-8(CAFD): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[8]);
	printf("%s","Cont. Input-9(SWD): ");
	scanf("%lg",&global_sw_train_2_MLP_10_39_1_input[9]);
	for(cont_inps=0;cont_inps<10;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(global_sw_train_2_MLP_10_39_1_input[cont_inps] == -9999)
	  global_sw_train_2_MLP_10_39_1_input[cont_inps]=global_sw_train_2_MLP_10_39_1_MeanInputs[cont_inps];
	}
    global_sw_train_2_MLP_10_39_1_ScaleInputs(global_sw_train_2_MLP_10_39_1_input,0,1,10);
	global_sw_train_2_MLP_10_39_1_RunNeuralNet_Regression();
	global_sw_train_2_MLP_10_39_1_UnscaleTargets(global_sw_train_2_MLP_10_39_1_output,0,1,1);
	printf("\n%s%.14e","Predicted Output of SWO = ",global_sw_train_2_MLP_10_39_1_output[0]);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

